<!DOCTYPE html>
<html lang="en">
<head>
    <title>My Website</title>
</head>
<body>
<article>
    <header>
        <h3 id="main_title">My Website</h3>
    </header>
    <p>
        <a href="mailto:fctorial@gmail.com?subject=I want to subscribe&body=I want to subscribe">Drop a mail if you would like to recieve email notification of new posts</a>
    </p>
    <p>
        Or use <a href="/static/rss.xml">this rss feed</a>
    </p>
    <ul id="posts"></ul>
</article>
</body>
<script constexpr src="/static/js/constexpr/lib.js"></script>
<script constexpr src="/static/js/constexpr/index.js"></script>
<script constexpr src="/static/js/constexpr/renderer.js"></script>

<script constexpr>
  async function page_specific_stuff() {
    const postsEl = document.querySelector('#posts')
    const posts = await (await fetch("/collections/posts.json")).json()
    posts.forEach(post => {
      let tags = ''
      post.tags.forEach(tag => {
        tags += `<a class="tag_element" href="/tags/generator.html?${tag}">${tag}</a> `
      })
      const el = make_element(`<li><a></a> ${tags}</li>`)
      const link = el.querySelector('a')
      link.setAttribute('href', post.url)
      link.innerText = post.title
      postsEl.appendChild(el)
    })
  }
</script>

<script constexpr>
  Promise.all([
    fetch('/static/rss.xml'), fetch('/favicon.ico'),
    render_page(), page_specific_stuff()
  ])
    .then(() => window._ConstexprJS_.compile())
</script>

<style>
    ul {
        margin-top: 2em;
    }
    ul li {
        margin: 1em;
    }
</style>
</html>
