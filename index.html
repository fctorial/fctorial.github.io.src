<!DOCTYPE html>
<html lang="en">
<head>
    <title>My Website</title>
</head>
<body>
<article>
    <header>
        <h3 id="main_title">My Website</h3>
    </header>
    <a href="mailto:fctorial@gmail.com?subject=I want to subscribe&body=I want to subscribe">Drop a mail if you would like to recieve email notification of new posts</a>
    <ul id="posts"></ul>
</article>
</body>
<script constexpr src="/static/js/constexpr/lib.js"></script>
<script constexpr src="/static/js/constexpr/index.js"></script>
<script constexpr src="/static/js/constexpr/renderer.js"></script>

<script constexpr>
  async function page_specific_stuff() {
    const postsEl = document.querySelector('#posts')
    const posts = await (await fetch("/collections/posts.json")).json()
    posts.forEach(post => {
      const el = make_element("<li><a></a></li>")
      const link = el.querySelector('a')
      link.setAttribute('href', post.url)
      link.innerText = post.title
      postsEl.appendChild(el)
    })
  }
</script>

<script constexpr>
  Promise.all([render_page(), page_specific_stuff()])
    .then(window._ConstexprJS_.compile())
</script>

<style>
    ul {
        margin-top: 2em;
    }
    ul li {
        margin: 1em;
    }
</style>
</html>
